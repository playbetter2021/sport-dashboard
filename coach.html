<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Coach Command | Data Ingestion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --gold: #D4AF37; --obsidian: #0a0a0a; }
        body { background-color: var(--obsidian); color: #e5e5e5; font-family: 'Inter', sans-serif; }
        .input-luxe { background: rgba(255,255,255,0.03); border: 1px solid rgba(212,175,55,0.3); color: var(--gold); padding: 12px; border-radius: 8px; width: 100%; }
        .section-card { background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05); padding: 25px; border-radius: 1.5rem; margin-bottom: 2rem; }
    </style>
</head>
<body class="p-10">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-black gold-gradient uppercase mb-10 text-center italic">Coach Data Entry Terminal</h1>
        
        <form id="proForm" class="space-y-6">
            <div class="section-card grid grid-cols-2 gap-4">
                <input type="text" id="pName" placeholder="Volledige Naam" class="input-luxe" required>
                <input type="number" id="pBirth" placeholder="Geboortejaar (bijv. 2010)" class="input-luxe" required>
            </div>

            <div class="section-card">
                <h3 class="text-[10px] font-black text-yellow-600 uppercase mb-4 tracking-widest">Objectieve Data (Prioriteit 1)</h3>
                <div class="grid grid-cols-2 gap-6">
                    <div><label class="text-[10px] block mb-2">Trainingsaanwezigheid (%)</label><input type="number" id="pAtt" class="input-luxe" value="100"></div>
                    <div><label class="text-[10px] block mb-2">Gespeelde Minuten (Totaal)</label><input type="number" id="pMin" class="input-luxe" value="1200"></div>
                </div>
            </div>

            <div class="section-card">
                <h3 class="text-[10px] font-black text-yellow-600 uppercase mb-4 tracking-widest">Techniek & Tactiek (1-5 Schaal)</h3>
                <div class="grid grid-cols-2 gap-6">
                    <div><label class="text-[10px] block mb-2">Technisch Niveau</label><input type="range" id="s_tech" min="1" max="5" value="3" class="w-full accent-yellow-500"></div>
                    <div><label class="text-[10px] block mb-2">Tactisch Inzicht</label><input type="range" id="s_tact" min="1" max="5" value="3" class="w-full accent-yellow-500"></div>
                </div>
            </div>

            <input type="password" id="ghToken" placeholder="GitHub Access Token" class="input-luxe mb-4" required>
            <button type="submit" class="w-full bg-yellow-600 text-black font-black py-4 rounded uppercase tracking-widest shadow-2xl hover:scale-105 transition">Submit Player Data</button>
        </form>
    </div>

    <script>
        document.getElementById('proForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            btn.innerText = "VALIDEREN & VERZENDEN...";

            const pData = {
                id: "p_" + Date.now(),
                bio: { name: document.getElementById('pName').value, birthYear: document.getElementById('pBirth').value, photo: "https://via.placeholder.com/400x600/0a0a0a/D4AF37?text=ASSET" },
                obj: { attendance: parseInt(document.getElementById('pAtt').value), minutes: parseInt(document.getElementById('pMin').value) },
                ratings: { tech: document.getElementById('s_tech').value, tact: document.getElementById('s_tact').value },
                stats: { "Techniek": document.getElementById('s_tech').value * 20, "Omschakeling": document.getElementById('s_tact').value * 20 },
                analysis: { strengths: "Objectieve seizoensscore berekend op basis van aanwezigheid en speeltijd." }
            };

            const token = document.getElementById('ghToken').value;
            const repo = "playbetter2021/sport-dashboard";
            const path = "data/players.json";

            try {
                const url = `https://api.github.com/repos/${repo}/contents/${path}`;
                const res = await fetch(url, { headers: { "Authorization": `token ${token}` } });
                const file = await res.json();
                let players = JSON.parse(atob(file.content));
                players.push(pData);
                await fetch(url, {
                    method: "PUT",
                    headers: { "Authorization": `token ${token}` },
                    body: JSON.stringify({ message: "Data-Driven Submission", content: btoa(unescape(encodeURIComponent(JSON.stringify(players, null, 2)))), sha: file.sha })
                });
                alert("Data succesvol opgeslagen en gevalideerd!");
            } catch (err) { alert(err.message); } finally { btn.innerText = "Submit Player Data"; }
        });
    </script>
</body>
</html>
