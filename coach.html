<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach Command | Elite Asset Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --gold: #D4AF37; --obsidian: #0a0a0a; }
        body { background-color: var(--obsidian); color: #e5e5e5; font-family: 'Inter', sans-serif; }
        .gold-text { color: var(--gold) !important; }
        .gold-gradient { background: linear-gradient(135deg, #D4AF37 0%, #F9E272 50%, #B8860B 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .input-luxe { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(212, 175, 55, 0.3); color: var(--gold); border-radius: 8px; padding: 12px; width: 100%; }
        .input-luxe:focus { border-color: #F9E272; outline: none; background: rgba(255, 255, 255, 0.07); }
        .section-card { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); padding: 25px; border-radius: 1.5rem; margin-bottom: 1.5rem; }
        .slider-gold { accent-color: var(--gold); cursor: pointer; width: 100%; }
        h3 { font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); border-bottom: 1px solid rgba(212, 175, 55, 0.2); padding-bottom: 8px; margin-bottom: 20px; font-weight: 800; }
        label { font-size: 10px; text-transform: uppercase; color: #888; font-weight: bold; margin-bottom: 4px; display: block; }
        select option { background-color: #0a0a0a; color: var(--gold); }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="mb-10 border-b border-yellow-900/30 pb-6 flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-3xl font-black italic gold-gradient tracking-tighter uppercase">Coach<span class="text-white not-italic font-light">Command</span></h1>
                <p class="text-[10px] uppercase tracking-[0.4em] text-gray-500">Volledig POP & Vaardigheden Dossier</p>
            </div>
            <div class="flex items-center gap-3 bg-white/5 p-2 rounded-xl border border-yellow-900/30">
                <label class="mb-0 ml-2">Asset Zoeken:</label>
                <select id="assetSearch" class="bg-transparent text-white text-xs font-bold uppercase outline-none cursor-pointer min-w-[150px]">
                    <option value="">-- KIES SPELER --</option>
                </select>
                <button id="loadBtn" class="bg-yellow-700/20 text-yellow-500 px-3 py-1 rounded text-[10px] font-bold hover:bg-yellow-700/40">LADEN</button>
            </div>
        </header>

        <form id="proPopForm" class="space-y-6">
            
            <div class="section-card">
                <h3>1. Algemene gegevens</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div><label>Naam speler:</label><input type="text" id="pName" class="input-luxe" required></div>
                    <div><label>Trainer / Coach:</label><input type="text" id="pCoach" class="input-luxe"></div>
                    <div>
                        <label>Team / Leeftijdscategorie:</label>
                        <select id="pTeam" class="input-luxe">
                            <option>JO8</option><option>JO9</option><option>JO10</option><option>JO11</option><option>JO12</option>
                            <option>JO13</option><option>JO14</option><option>JO15</option><option>JO16</option><option>JO17</option>
                            <option>JO19</option><option>Senioren</option>
                        </select>
                    </div>
                    <div>
                        <label>Positie:</label>
                        <select id="pPos" class="input-luxe">
                            <option>Keeper</option><option>Verdediger</option><option>Middenvelder</option><option>Aanvaller</option>
                        </select>
                    </div>
                    <div>
                        <label>Periode:</label>
                        <select id="pPeriod" class="input-luxe">
                            <option>Voorseizoen</option><option>1e seizoenshelft</option><option>2e seizoenshelft</option><option>Seizoen</option>
                        </select>
                    </div>
                    <div><label>Datum evaluatie:</label><input type="date" id="pDate" class="input-luxe"></div>
                </div>
            </div>

            <div class="section-card">
                <h3>Technische vaardigheden (1-5)</h3>
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center border-b border-white/5 pb-2">
                        <div class="flex justify-between"><label>Balcontrole</label><span id="v_bal" class="gold-text font-bold">3</span></div>
                        <input type="range" id="s_bal" min="1" max="5" value="3" class="slider-gold" oninput="v_bal.innerText=this.value">
                        <input type="text" id="o_bal" placeholder="Opmerking" class="input-luxe text-xs">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center border-b border-white/5 pb-2">
                        <div class="flex justify-between"><label>Passen</label><span id="v_pas" class="gold-text font-bold">3</span></div>
                        <input type="range" id="s_pas" min="1" max="5" value="3" class="slider-gold" oninput="v_pas.innerText=this.value">
                        <input type="text" id="o_pas" placeholder="Opmerking" class="input-luxe text-xs">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center border-b border-white/5 pb-2">
                        <div class="flex justify-between"><label>Aannemen</label><span id="v_aan" class="gold-text font-bold">3</span></div>
                        <input type="range" id="s_aan" min="1" max="5" value="3" class="slider-gold" oninput="v_aan.innerText=this.value">
                        <input type="text" id="o_aan" placeholder="Opmerking" class="input-luxe text-xs">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center border-b border-white/5 pb-2">
                        <div class="flex justify-between"><label>Dribbelen</label><span id="v_drib" class="gold-text font-bold">3</span></div>
                        <input type="range" id="s_drib" min="1" max="5" value="3" class="slider-gold" oninput="v_drib.innerText=this.value">
                        <input type="text" id="o_drib" placeholder="Opmerking" class="input-luxe text-xs">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center border-b border-white/5 pb-2">
                        <div class="flex justify-between"><label>Schieten</label><span id="v_schot" class="gold-text font-bold">3</span></div>
                        <input type="range" id="s_schot" min="1" max="5" value="3" class="slider-gold" oninput="v_schot.innerText=this.value">
                        <input type="text" id="o_schot" placeholder="Opmerking" class="input-luxe text-xs">
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="section-card">
                    <h3>Tactiek & Fysiek</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center"><label>Samenwerken</label><span id="v_sam" class="gold-text">3</span></div>
                        <input type="range" id="s_sam" min="1" max="5" value="3" class="slider-gold" oninput="v_sam.innerText=this.value">
                        <div class="flex justify-between items-center"><label>Snelheid</label><span id="v_sne" class="gold-text">3</span></div>
                        <input type="range" id="s_sne" min="1" max="5" value="3" class="slider-gold" oninput="v_sne.innerText=this.value">
                    </div>
                </div>
                <div class="section-card">
                    <h3>Mentaal & Houding</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center"><label>Inzet</label><span id="v_inz" class="gold-text">3</span></div>
                        <input type="range" id="s_inz" min="1" max="5" value="3" class="slider-gold" oninput="v_inz.innerText=this.value">
                        <div class="flex justify-between items-center"><label>Coachbaarheid</label><span id="v_coa" class="gold-text">3</span></div>
                        <input type="range" id="s_coa" min="1" max="5" value="3" class="slider-gold" oninput="v_coa.innerText=this.value">
                    </div>
                </div>
            </div>

            <div class="section-card">
                <h3>Persoonlijk Ontwikkelingsplan (POP)</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <textarea id="pStrengths" class="input-luxe h-24" placeholder="Sterke punten..."></textarea>
                    <textarea id="pGrowthPoints" class="input-luxe h-24" placeholder="Ontwikkelpunten..."></textarea>
                </div>
                <div class="space-y-4">
                    <input type="text" id="goal1" placeholder="Doel 1 | Actie | Tijdspad" class="input-luxe">
                    <input type="text" id="goal2" placeholder="Doel 2 | Actie | Tijdspad" class="input-luxe">
                </div>
            </div>

            <div class="section-card">
                <input type="password" id="ghToken" placeholder="GITHUB ACCESS TOKEN" class="input-luxe text-xs mb-4" required>
                <button type="submit" id="saveBtn" class="bg-gradient-to-r from-yellow-600 to-yellow-400 text-black font-black py-4 rounded w-full uppercase tracking-widest hover:scale-[1.01] transition shadow-2xl">
                    Sla Dossier Op & Sync Cloud
                </button>
            </div>
        </form>
    </div>

    <script type="module">
        import DataProvider from './js/data_provider.js';
        let allPlayers = [];

        async function loadAssets() {
            allPlayers = await DataProvider.getAllPlayers();
            const search = document.getElementById('assetSearch');
            search.innerHTML = '<option value="">-- KIES SPELER --</option>' + 
                allPlayers.map(p => `<option value="${p.id}">${p.bio.name}</option>`).join('');
        }

        document.getElementById('loadBtn').addEventListener('click', (e) => {
            e.preventDefault();
            const id = document.getElementById('assetSearch').value;
            const p = allPlayers.find(x => x.id === id);
            if (!p) return;

            document.getElementById('pName').value = p.bio.name;
            document.getElementById('pTeam').value = p.bio.team;
            document.getElementById('pPos').value = p.bio.role;
            document.getElementById('pCoach').value = p.bio.coach || "";
            document.getElementById('pGrowthPoints').value = p.analysis.growthPoints || "";
            document.getElementById('pStrengths').value = p.analysis.strengths || "";

            const r = p.ratings || {};
            const sync = (sId, vId, val) => {
                if(document.getElementById(sId)) {
                    document.getElementById(sId).value = val || 3;
                    document.getElementById(vId).innerText = val || 3;
                }
            };
            sync('s_bal', 'v_bal', r.bal); sync('s_pas', 'v_pas', r.pas);
            sync('s_sam', 'v_sam', r.sam); sync('s_sne', 'v_sne', r.sne);
            alert("Data geladen voor " + p.bio.name);
        });

        document.getElementById('proPopForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('saveBtn');
            btn.innerText = "SYNCHRONISEREN...";

            const pId = document.getElementById('assetSearch').value || "p_" + Date.now();
            const pData = {
                id: pId,
                bio: {
                    name: document.getElementById('pName').value.toUpperCase(),
                    team: document.getElementById('pTeam').value,
                    role: document.getElementById('pPos').value,
                    coach: document.getElementById('pCoach').value,
                    date: document.getElementById('pDate').value,
                    photo: "https://via.placeholder.com/400x600/0a0a0a/D4AF37?text=" + document.getElementById('pName').value
                },
                ratings: {
                    bal: document.getElementById('s_bal').value,
                    pas: document.getElementById('s_pas').value,
                    sam: document.getElementById('s_sam').value,
                    sne: document.getElementById('s_sne').value
                },
                analysis: {
                    strengths: document.getElementById('pStrengths').value,
                    growthPoints: document.getElementById('pGrowthPoints').value
                },
                stats: {
                    "Techniek": parseInt(document.getElementById('s_bal').value) * 20,
                    "Tactiek": parseInt(document.getElementById('s_sam').value) * 20,
                    "Fysiek": parseInt(document.getElementById('s_sne').value) * 20
                }
            };

            const token = document.getElementById('ghToken').value;
            const repo = "playbetter2021/sport-dashboard";
            const path = "data/players.json";

            try {
                const url = `https://api.github.com/repos/${repo}/contents/${path}`;
                const getRes = await fetch(url, { headers: { "Authorization": `token ${token}` } });
                const fileData = await getRes.json();
                let players = JSON.parse(atob(fileData.content));
                const index = players.findIndex(p => p.id === pId);
                if (index !== -1) players[index] = pData; else players.push(pData);

                await fetch(url, {
                    method: "PUT",
                    headers: { "Authorization": `token ${token}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        message: `Update: ${pData.bio.name}`,
                        content: btoa(unescape(encodeURIComponent(JSON.stringify(players, null, 2)))),
                        sha: fileData.sha
                    })
                });
                alert("Cloud Sync Succesvol!");
                location.reload();
            } catch (err) {
                alert("Fout: " + err.message);
                btn.innerText = "Sla Dossier Op & Sync Cloud";
            }
        });
        loadAssets();
    </script>
</body>
</html>
