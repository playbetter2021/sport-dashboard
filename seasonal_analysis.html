async function init() {
    const players = await DataProvider.getAllPlayers();
    
    const tiers = {
        t1: { players: [], counts: { Keeper: 0, Verdediger: 0, Middenvelder: 0, Aanvaller: 0 } },
        t2: { players: [], counts: { Keeper: 0, Verdediger: 0, Middenvelder: 0, Aanvaller: 0 } },
        t3: { players: [], counts: { Keeper: 0, Verdediger: 0, Middenvelder: 0, Aanvaller: 0 } }
    };

    players.forEach(p => {
        const score = calcIndex(p);
        const startScore = p.history?.["1e seizoenshelft"] ? calcIndex({...p, ...p.history["1e seizoenshelft"], ratings: p.history["1e seizoenshelft"].ratings}) : score;
        const growth = score - startScore;
        const role = p.bio.role;

        let targetTier;
        if (score >= 72 || (score > 65 && growth > 5)) targetTier = tiers.t1;
        else if (score >= 58 || growth > 8) targetTier = tiers.t2;
        else targetTier = tiers.t3;

        targetTier.players.push(renderPlayerRow(p, score, growth));
        targetTier.counts[role]++;
    });

    // Render de lijsten en de Positie-Check
    ['t1', 't2', 't3'].forEach(t => {
        document.getElementById(`tier${t.at(1)}-list`).innerHTML = tiers[t].players.join('');
        document.getElementById(`count-${t}`).innerText = `${tiers[t].players.length} Assets`;
        
        // Waarschuwing als er geen keeper is
        if(tiers[t].counts.Keeper === 0 && tiers[t].players.length > 0) {
            document.getElementById(`tier${t.at(1)}-list`).innerHTML += `
                <div class="m-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-[9px] text-red-500 font-black uppercase text-center">
                    ⚠️ Waarschuwing: Geen Keeper gedetecteerd in deze Tier
                </div>`;
        }
    });
}

function renderPlayerRow(p, score, growth) {
    return `
        <div class="player-row p-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="${p.bio.photo}" class="w-8 h-8 rounded-full border border-white/10 object-cover">
                <div>
                    <p class="text-[10px] font-black text-white uppercase leading-none">${p.bio.name}</p>
                    <p class="text-[8px] text-gray-500 mt-1 uppercase">${p.bio.role}</p>
                </div>
            </div>
            <div class="text-right">
                <p class="text-xs font-black text-white">${score}%</p>
                ${growth > 3 ? '<span class="gold-tag">↑ POTENTIAL</span>' : ''}
            </div>
        </div>
    `;
}
