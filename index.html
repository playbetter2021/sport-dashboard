<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Sport Analytics | World Class Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --gold: #D4AF37; --obsidian: #0a0a0a; }
        body { background-color: var(--obsidian); background-image: radial-gradient(circle at 50% -20%, #1a1a1a 0%, #0a0a0a 100%); }
        .gold-gradient { background: linear-gradient(135deg, #D4AF37 0%, #F9E272 50%, #B8860B 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gold-border { border: 1px solid rgba(212, 175, 55, 0.3); }
        .glass-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.05); }
    </style>
</head>
<body class="text-gray-300 font-sans antialiased p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="flex justify-between items-center mb-8 border-b border-yellow-900/30 pb-6">
            <div>
                <h1 class="text-3xl font-black italic gold-gradient tracking-tighter">ELITE<span class="text-white not-italic">GOLD</span></h1>
                <p class="text-[10px] uppercase tracking-[0.3em] text-gray-500 font-bold">Intelligence System v2.0</p>
            </div>
            <div class="flex items-center gap-4">
                <div class="text-right hidden md:block">
                    <p class="text-[9px] uppercase text-yellow-600 font-bold tracking-widest">Selected Asset</p>
                    <p id="topPlayerName" class="text-white font-bold uppercase tracking-tighter">Laden...</p>
                </div>
                <select id="playerSelector" class="bg-black border gold-border text-[#D4AF37] py-2 px-4 rounded outline-none cursor-pointer text-xs font-bold uppercase"></select>
            </div>
        </header>

        <div class="grid grid-cols-1 xl:grid-cols-12 gap-6">
            
            <div class="xl:col-span-3 space-y-6">
                <div class="glass-card p-1 rounded-3xl gold-border overflow-hidden relative">
                    <img id="playerPhoto" class="w-full h-80 object-cover rounded-2xl grayscale hover:grayscale-0 transition duration-500" src="" alt="">
                    <div class="absolute bottom-4 left-4">
                        <span id="playerNumber" class="text-5xl font-black text-white italic opacity-50">--</span>
                    </div>
                </div>

                <div class="glass-card p-6 rounded-2xl gold-border space-y-4">
                    <h3 class="text-[10px] uppercase text-yellow-600 font-bold tracking-widest border-b border-white/10 pb-2">Biometrics</h3>
                    <div class="flex justify-between">
                        <span class="text-xs text-gray-500">Position</span>
                        <span id="playerRole" class="text-xs text-white font-bold uppercase">--</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-xs text-gray-500">Squad Status</span>
                        <span id="playerStatus" class="text-xs gold-gradient font-bold uppercase italic">--</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-xs text-gray-500">Sport</span>
                        <span id="playerSport" class="text-xs text-white font-bold uppercase">--</span>
                    </div>
                </div>
            </div>

            <div class="xl:col-span-6 space-y-6">
                <div class="glass-card p-8 rounded-3xl gold-border relative h-[450px]">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xs uppercase tracking-widest font-bold text-gray-400 italic">Performance Radar</h3>
                        <div class="bg-yellow-600/10 px-3 py-1 rounded-full border border-yellow-600/30">
                            <span class="text-[10px] text-yellow-600 font-bold">AVG SCORE: <span id="avgScore">0</span>%</span>
                        </div>
                    </div>
                    <canvas id="performanceChart"></canvas>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div class="glass-card p-4 rounded-xl text-center border-t-2 border-yellow-600">
                        <p class="text-[9px] uppercase text-gray-500">Speed Level</p>
                        <p id="stat_speed" class="text-xl font-bold text-white">0</p>
                    </div>
                    <div class="glass-card p-4 rounded-xl text-center border-t-2 border-yellow-600">
                        <p class="text-[9px] uppercase text-gray-500">Skill Level</p>
                        <p id="stat_tech" class="text-xl font-bold text-white">0</p>
                    </div>
                    <div class="glass-card p-4 rounded-xl text-center border-t-2 border-yellow-600">
                        <p class="text-[9px] uppercase text-gray-500">Condition</p>
                        <p id="stat_stamina" class="text-xl font-bold text-white">0</p>
                    </div>
                </div>
            </div>

            <div class="xl:col-span-3 space-y-6">
                <div class="glass-card p-6 rounded-3xl gold-border">
                    <h3 class="text-[10px] uppercase text-yellow-600 font-bold tracking-widest mb-4">Squad Ranking</h3>
                    <div id="rankingTable" class="space-y-3">
                        </div>
                </div>

                <div class="glass-card p-6 rounded-3xl border border-white/5">
                    <h3 class="text-[10px] uppercase text-gray-500 font-bold tracking-widest mb-4">Actions</h3>
                    <a href="coach.html" class="block w-full text-center py-3 bg-white/5 hover:bg-yellow-600/20 text-[10px] font-bold tracking-widest uppercase transition rounded-lg border border-white/10">Open Command Panel</a>
                </div>
            </div>

        </div>
    </div>

    <script type="module">
        import DataProvider from './js/data_provider.js';
        let myChart = null;

        async function init() {
            const players = await DataProvider.getAllPlayers();
            const selector = document.getElementById('playerSelector');
            if (!players || players.length === 0) return;

            // Selector vullen
            selector.innerHTML = players.map(p => `<option value="${p.id}">${p.bio.name.toUpperCase()}</option>`).join('');

            const updateUI = (id) => {
                const p = players.find(player => player.id === id);
                
                // Basis Info
                document.getElementById('topPlayerName').textContent = p.bio.name;
                document.getElementById('playerPhoto').src = p.bio.photo;
                document.getElementById('playerRole').textContent = p.bio.role;
                document.getElementById('playerStatus').textContent = p.status;
                document.getElementById('playerNumber').textContent = p.bio.number;
                document.getElementById('playerSport').textContent = p.sport;

                // Stats
                document.getElementById('stat_speed').textContent = p.stats['Snelheid'] || 0;
                document.getElementById('stat_tech').textContent = p.stats['Techniek'] || 0;
                document.getElementById('stat_stamina').textContent = p.stats['Conditie'] || 0;

                // Gemiddelde berekenen
                const values = Object.values(p.stats);
                const avg = Math.round(values.reduce((a, b) => a + b, 0) / values.length);
                document.getElementById('avgScore').textContent = avg;

                drawChart(p.stats);
                updateRanking(players);
            };

            const drawChart = (stats) => {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                if (myChart) myChart.destroy();
                myChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: Object.keys(stats),
                        datasets: [{
                            data: Object.values(stats),
                            backgroundColor: 'rgba(212, 175, 55, 0.2)',
                            borderColor: '#D4AF37',
                            borderWidth: 2,
                            pointRadius: 4,
                            pointBackgroundColor: '#F9E272'
                        }]
                    },
                    options: {
                        scales: {
                            r: {
                                grid: { color: 'rgba(255,255,255,0.05)' },
                                angleLines: { color: 'rgba(255,255,255,0.05)' },
                                pointLabels: { color: '#888', font: { size: 10 } },
                                ticks: { display: false },
                                suggestedMin: 0, suggestedMax: 100
                            }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            };

            const updateRanking = (allPlayers) => {
                const container = document.getElementById('rankingTable');
                // Sorteer op gemiddelde van stats
                const sorted = [...allPlayers].sort((a,b) => {
                    const avgA = Object.values(a.stats).reduce((x,y)=>x+y,0)/Object.values(a.stats).length;
                    const avgB = Object.values(b.stats).reduce((x,y)=>x+y,0)/Object.values(b.stats).length;
                    return avgB - avgA;
                });

                container.innerHTML = sorted.slice(0, 5).map((p, i) => `
                    <div class="flex justify-between items-center bg-white/5 p-3 rounded-lg border border-white/5">
                        <span class="text-[10px] font-bold text-yellow-600">#${i+1}</span>
                        <span class="text-[10px] uppercase text-white font-bold">${p.bio.name}</span>
                        <span class="text-[10px] text-gray-500">${Math.round(Object.values(p.stats).reduce((a,b)=>a+b,0)/Object.values(p.stats).length)}%</span>
                    </div>
                `).join('');
            };

            selector.addEventListener('change', (e) => updateUI(e.target.value));
            updateUI(players[0].id);
        }

        init();
    </script>
</body>
</html>
